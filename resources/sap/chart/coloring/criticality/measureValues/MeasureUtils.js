sap.ui.define(['sap/chart/coloring/ColoringUtils','sap/chart/coloring/criticality/measureValues/ThresholdsUtils','sap/chart/ChartLog','sap/chart/library'],function(C,T,a,c){"use strict";var t=jQuery.type;var b=c.coloring.CriticalityType;var m={ge:"\u2265",lt:"<",le:"\u2264",gt:">"};var M={Static:{},Calculated:{},DynamicThresholds:{},ConstantThresholds:{},Unmentioned:{}};M.Static.parse=function(o,e,p){var s=o.msr?o.msr.getName():undefined;var S=o.settings[o.type];p.callbacks=M.Static.getCallbacks(S,s);var D=o.msr.getLabel()||o.msr.getName();var f=o.settings.Legend||{};p.legend[S]=(f[S]!=null)?f[S]:D;};M.Static.getCallbacks=function(s,e){var f={};f[s]=[function(o){return o.hasOwnProperty(e);}];return f;};M.Calculated.parse=function(o,e,p,f){var s=o.settings[o.type];if(!C.find(s,e.aDims)){p.additionalDimensions.push(s);}p.status=e.oStatus;};M.Calculated.getCallbacks=function(p,s,e){var f=function(o){return(o[p]===s)&&o.hasOwnProperty(e);};return[f];};M.Calculated.getContextHandler=function(e,f,l){var o=e[0];var s=o.settings[o.type];return function(g){var S=o.parsed.status;S.legend=S.legend||{};S.callbacks=S.callbacks||{};o.parsed.legend=S.legend;o.parsed.callbacks=S.callbacks;var h=g.getProperty(s);var i=this.getDimensionByName(s);var D=this.getDimensionByName(s).getDisplayText();e.legendTitle=e.legendTitle||i.getLabel();if(!i){throw new a('error','Colorings.Criticality.Calculated','Calculated property does not exist in data model');}var j=i.getTextProperty();if(j&&D){var k=g.getProperty(j);o.parsed.legend[h]=k;}else if(h){o.parsed.legend[h]=l.getText("COLORING_TYPE_"+h.toUpperCase());}var n=o.msr.getName();var p=M.Calculated.getCallbacks(s,h,n);o.parsed.callbacks[h]=p;};};M.DynamicThresholds.parse=function(o,e,p,f,l){var s=o.settings[o.type];var g=o.msr?o.msr.getName():undefined;var D=s.ImprovementDirection.toLowerCase();var h={lo:s.ToleranceRangeLowValue,hi:s.ToleranceRangeHighValue};var i={lo:s.DeviationRangeLowValue,hi:s.DeviationRangeHighValue};d(D,h,i);var B={};if(s.Breakdown){B.NegativeLevels=s.Breakdown.NegativeLevels;B.CriticalLevels=s.Breakdown.CriticalLevels;B.PositiveLevels=s.Breakdown.PositiveLevels;B.MinimumMeasureValue=s.Breakdown.MinimumMeasureValue;B.MaximumMeasureValue=s.Breakdown.MaximumMeasureValue;}p.callbacks=T.improvement(D,g,h,i,B);p.additionalMeasures=[h.lo,h.hi,i.lo,i.hi,B.MinimumMeasureValue,B.MaximumMeasureValue].filter(function(v){return t(v)==='string';});var j={};jQuery.each(b,function(k,v){j[v]=l.getText("COLORING_TYPE_"+v.toUpperCase());});p.legend=jQuery.extend(true,{},j,o.settings.Legend);};function d(D,o,e,f){var E,r;switch(D){case'maximize':E=e.lo!=undefined&&o.lo!=undefined;r=(C.isNumber(e.lo,o.lo)&&(e.lo<o.lo));break;case'minimize':E=o.hi!=undefined&&e.hi!=undefined;r=(C.isNumber(o.hi,e.hi)&&(o.hi<e.hi));break;case'target':E=e.lo!=undefined&&o.lo!=undefined&&o.hi!=undefined&&e.hi!=undefined;r=(C.isNumber(e.lo,o.lo,o.hi,e.hi)&&(e.lo<o.lo)&&(o.lo<o.hi)&&(o.hi<e.hi));break;default:}if(!E||(f&&!r)){var s=f?"ConstantThresholds":"DynamicThresholds";throw new a('error','Colorings.Criticality.'+s,'Invalid Thresholds settings');}}M.ConstantThresholds.parse=function(o,e,p,f){var s=o.settings[o.type];var g=o.msr?o.msr.getName():undefined;var D=s.ImprovementDirection.toLowerCase();var h={lo:o.byAggregation.ToleranceRangeLowValue,hi:o.byAggregation.ToleranceRangeHighValue};var i={lo:o.byAggregation.DeviationRangeLowValue,hi:o.byAggregation.DeviationRangeHighValue};d(D,h,i,true);var B={};if(s.Breakdown){B.NegativeLevels=s.Breakdown.NegativeLevels;B.CriticalLevels=s.Breakdown.CriticalLevels;B.PositiveLevels=s.Breakdown.PositiveLevels;B.MinimumMeasureValue=o.byAggregation.Breakdown.MinimumMeasureValue;B.MaximumMeasureValue=o.byAggregation.Breakdown.MaximumMeasureValue;}if(f){p.legend=T.MBCimprovement(D,h,i);}else{p.callbacks=T.improvement(D,g,h,i,B);p.additionalMeasures=[h.lo,h.hi,i.lo,i.hi,B.MinimumMeasureValue,B.MaximumMeasureValue].filter(function(v){return t(v)==='string';});p.legend=M.ConstantThresholds.getLegend(D,g,h,i);}};M.ConstantThresholds.getLegend=function(D,s,o,e){var l={};var f=s+' '+m.ge+' '+o.lo;var g=e.lo+' '+m.le+' '+s+' '+m.lt+' '+o.lo;var h=s+' '+m.lt+' '+e.lo;var i=s+' '+m.le+' '+o.hi;var j=o.hi+' '+m.lt+' '+s+' '+m.le+' '+e.hi;var k=s+' '+m.gt+' '+e.hi;switch(D){case'maximize':l={Positive:f,Critical:g,Negative:h};break;case'minimize':l={Positive:i,Critical:j,Negative:k};break;case'target':l={Positive:o.lo+' '+m.le+' '+s+' '+m.le+' '+o.hi,Critical:g+' , '+j,Negative:h+' , '+k};break;default:}return l;};M.ConstantThresholds.getContextHandler=function(e,f){if(f){var o=e[0];var s=o.msr.getName();var l=o.parsed.legend;return function(g){var v=g.getProperty(s);l.min=Math.min(l.min,v);l.max=Math.max(l.max,v);};}else{return null;}};M.Unmentioned.getCallbacks=function(e){var f={'Unmentioned':e.map(function(o){return function(g){return g.hasOwnProperty(o.getName());};})};return f;};M.Unmentioned.parse=function(o,e,p){p.callbacks=M.Unmentioned.getCallbacks(o.settings);p.legend=o.settings.map(function(f){return f.getLabel()||f.getName();});};return M;});
