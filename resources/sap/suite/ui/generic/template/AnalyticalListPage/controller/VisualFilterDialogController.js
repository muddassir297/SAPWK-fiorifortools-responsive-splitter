sap.ui.define(["sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Dialog","sap/m/Bar","sap/m/SearchField","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Title","sap/m/VBox","sap/m/HBox","sap/m/CheckBox","sap/m/Link","sap/m/List","sap/m/TextArea","sap/m/Text","sap/m/StandardListItem","sap/m/ListSeparators","sap/m/Popover","sap/ui/layout/form/SimpleForm","sap/ui/layout/GridData","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/m/SegmentedButton","sap/m/SegmentedButtonItem"],function(B,a,L,D,b,S,T,c,d,V,H,C,e,f,g,h,j,k,P,l,G,m,F,n,o){"use strict";var p="_BASIC";var q,r,s,t;var u="100%";var v=0.33;var w=0.5;var x=m.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController",{init:function(i){this.oState=i;this.oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");},launchDialog:function(){var i=this;this.oConfig=this.oState.alr_visualFilterBar.getConfig();this._filterModified=false;this.filterCompList=[];this.filterChartList=[];this._buildFiltersFromConfig();this.oVFDialog=new sap.m.Dialog({title:this.oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"),afterClose:function(){i.oVFDialog.destroy();}});this.oVFDialog.setModel(this.oState.oController.getView().getModel("_templPriv"),"_templPriv");this.oVFDialog.setModel(this.oState.oController.getView().getModel());this.oVFDialog.setModel(this.oState.oController.getView().getModel("i18n"),"i18n");this.oVFDialog.setVerticalScrolling(true);this._addDialogButtons();this.oVFDialog.addStyleClass("sapUiPopupWithPadding");this.oVFDialog.addStyleClass("sapUiSizeCompact");this.oVFDialog.addStyleClass("sapUiCompFilterBarDialog");var y=new b();var z=new S({placeholder:this.oRb.getText("FILTER_BAR_SEARCH")});z.attachLiveChange(function(E){if(i.oVFDialog){i._triggerSearchInFilterDialog(E);}});y.addContentRight(z);this.oVFDialog.setSubHeader(y);this.oVerticalBox=new V();this.oVerticalBox.addStyleClass("sapUiNoContentPadding");this.oVFDialog.addContent(this.oVerticalBox);this._addFilterSwitch();this._addGroupsAndFilters();this.oVFDialog.open();},_addFilterSwitch:function(){var i=[new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-fields",width:"inherit",key:"compact",tooltip:"{i18n>FILTER_COMPACT}"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-analytics",width:"inherit",key:"visual",tooltip:"{i18n>FILTER_VISUAL}"})];var y=new n({width:"inherit",selectedKey:"visual",items:i});y.attachSelect(function(){this.oState.alr_visualFilterBar._setVariantModified();this.oState.alr_visualFilterBar.setConfig(this._rebuildConfig(),true);this.oState.filterBarController.onGoFilter();this.oVFDialog.close();this.oState.oSmartFilterbar.showFilterDialog();}.bind(this));var z=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,content:[new sap.m.ToolbarSpacer(),y]}).addStyleClass("alpFilterDialogToolbar");this.oVerticalBox.addItem(z);},_addDialogButtons:function(){var i=this;s=new B({text:this.oRb.getText("FILTER_BAR_GO"),type:a.Emphasized,press:function(E){i.oState.alr_visualFilterBar._setVariantModified();i.oState.alr_visualFilterBar.setConfig(i._rebuildConfig(),true);i.oState.filterBarController.onGoFilter();i.oVFDialog.close();}});q=new B({text:this.oRb.getText("FILTER_BAR_CLEAR"),press:function(E){i._clearFilters();}});r=new B({text:this.oRb.getText("FILTER_BAR_RESTORE"),press:function(E){i.oState.alr_visualFilterBar.fireFilterChange({bRestoreCompactFilter:true});i._buildFiltersFromConfig();i.oVerticalBox.removeAllItems();i._addFilterSwitch();i._addGroupsAndFilters();}});t=new B({text:this.oRb.getText("FILTER_BAR_CANCEL"),press:function(E){i.oState.alr_visualFilterBar.fireFilterChange({bRestoreCompactFilter:true});i.oVFDialog.close();}});this.oVFDialog.addButton(s);this.oVFDialog.addButton(q);this.oVFDialog.addButton(r);this.oVFDialog.addButton(t);this.oVFDialog.attachAfterClose(function(){i.oVFDialog.destroy();i.oVFDialog=null;});},_buildFiltersFromConfig:function(){var i;this.filterCompList=[];this.filterChartList=[];for(i=0;i<this.oConfig.filterCompList.length;i++){this.filterCompList.push({obj:{shownInFilterBar:this.oConfig.filterCompList[i].shownInFilterBar,shownInFilterDialog:this.oConfig.filterCompList[i].shownInFilterDialog,cellHeight:this.oConfig.filterCompList[i].cellHeight,component:{type:this.oConfig.filterCompList[i].component.type,cellHeight:this.oConfig.filterCompList[i].component.cellHeight},group:{label:this.oConfig.filterCompList[i].group.label,name:this.oConfig.filterCompList[i].group.name}},searchVisible:true,toolbar:this._addChartCustomToolbar(this.oConfig.filterCompList[i],i)});this.filterChartList.push(this._addChart(this.oConfig.filterCompList[i].component.type,this.oConfig.filterCompList[i].component.properties,i));}this._applyFilterSelections();},_rebuildConfig:function(){var i;var y={filterCompList:[]};for(i=0;i<this.filterCompList.length;i++){y.filterCompList.push({shownInFilterBar:this.filterCompList[i].obj.shownInFilterBar&&this.filterCompList[i].obj.shownInFilterDialog,shownInFilterDialog:this.filterCompList[i].obj.shownInFilterDialog,cellHeight:this.filterCompList[i].obj.cellHeight,group:{label:this.filterCompList[i].obj.group.label,name:this.filterCompList[i].obj.group.name},component:{type:this.filterCompList[i].obj.component.type,cellHeight:this.filterCompList[i].obj.component.cellHeight,properties:{scaleFactor:this.filterChartList[i].getScaleFactor(),sortOrder:this.filterChartList[i].getSortOrder(),filterRestriction:this.oConfig.filterCompList[i].component.properties.filterRestriction,entitySet:this.filterChartList[i].getEntitySet(),width:this.oConfig.filterCompList[i].component.properties.width,height:this.oConfig.filterCompList[i].component.properties.height,dimensionField:this.filterChartList[i].getDimensionField(),dimensionFieldDisplay:this.filterChartList[i].getDimensionFieldDisplay(),dimensionFieldIsDateTime:this.filterChartList[i].getDimensionFieldIsDateTime(),dimensionFilter:this.filterChartList[i].getDimensionFilter(),unitField:this.filterChartList[i].getUnitField(),isCurrency:this.filterChartList[i].getIsCurrency(),isMandatory:this.oConfig.filterCompList[i].component.properties.isMandatory,measureField:this.filterChartList[i].getMeasureField(),measureSortDescending:this.filterChartList[i].getMeasureSortDescending(),outParameter:this.oConfig.filterCompList[i].component.properties.outParameter,inParameters:this.oConfig.filterCompList[i].component.properties.inParameters,parentProperty:this.oConfig.filterCompList[i].component.properties.parentProperty}}});}return y;},_addGroupsAndFilters:function(){var i;var y;var z;var A=0;for(i=0;i<this.filterCompList.length;i++){if(!Array.isArray(this.filterCompList[i])){if(this.filterCompList[i].searchVisible===false){continue;}if(!y||(y!=this.filterCompList[i].obj.group.name)){if(z){this.oVerticalBox.addItem(z);}y=this.filterCompList[i].obj.group.name;z=new V();z.setWidth("100%");z.setLayoutData(new G({span:"L12 M12 S12"}));A++;this._addGroupToolbar(z,this.filterCompList[i].obj.group.label,this.filterCompList[i].obj.group.name);}if(this.filterCompList[i].obj.shownInFilterDialog){var E=new V();E.addStyleClass("alp_graphicalFilterDialogChartViewContainer");E.addStyleClass("sapSuiteVisualFilterBar");E.addItem(this.filterCompList[i].toolbar);E.addItem(this.filterChartList[i]);this._updateFilterCount(i);z.addItem(E);}}if(z){this.oVerticalBox.addItem(z);}}if(A<=1){F.executeFunction(z,"mAggregations.items.0.setVisible",[false]);}},_addGroupToolbar:function(i,y,z){var A=new T({content:[new d({text:y}),new c()]});if(z!=p){A.addContent(this._createMoreFiltersLink(z));}i.addItem(A);},_addChartCustomToolbar:function(i,y){var z=this;var A=i.component.properties.sortOrder[0].Descending.Boolean;var E=this._getChartTypeIconLink(i.component.type);var I=new H({items:[new C({text:"",selected:i.shownInFilterBar,select:function(K){var y=K.getSource().data("idx");z.filterCompList[y].obj.shownInFilterBar=this.getSelected();}}).data("idx",y)]});var J=new H({items:[new B({type:"Transparent",text:"",enabled:"{= !${_templPriv>/alp/visualFilter/"+i.component.properties.parentProperty+"/hasMultiUnit} }",press:function(K){sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController.launchAllFiltersPopup(K.getSource(),z.filterChartList[K.getSource().data("idx")],K.getSource().getModel('i18n'));}}).data("idx",y),new B({type:"Transparent",icon:"sap-icon://line-chart-time-axis",visible:false,press:function(K){z._showLineChartTimeAxisPopup(K);}}).data("idx",y),new B({type:"Transparent",icon:(A?"sap-icon://sort-descending":"sap-icon://sort-ascending"),visible:true,tooltip:"{i18n>VISUAL_FILTER_SORT_ORDER}",press:function(K){z._showChartSortPopup(K);}}).data("idx",y),new B({type:"Transparent",icon:E,tooltip:"{i18n>VISUAL_FILTER_CHART_TYPE}",press:function(K){z._showChartTypesPopup(K);}}).data("idx",y),new B({type:"Transparent",icon:"sap-icon://measure",tooltip:"{i18n>VISUAL_FILTER_MEASURE}",press:function(K){z._showChartMeasuresPopup(K);}}).data("idx",y)]});J.setWidth("100%");J.setJustifyContent(sap.m.FlexJustifyContent.End);I.setWidth("100%");I.addItem(J);return I;},_addChart:function(i,y,z){var A;var E=this;var I={scaleFactor:y.scaleFactor,sortOrder:y.sortOrder,filterRestriction:y.filterRestriction,width:u,height:y.height,labelWidthPercent:v,entitySet:y.entitySet,dimensionField:y.dimensionField,dimensionFieldDisplay:y.dimensionFieldDisplay,dimensionFieldIsDateTime:y.dimensionFieldIsDateTime,unitField:y.unitField,isCurrency:y.isCurrency,isMandatory:y.isMandatory,measureField:y.measureField,dimensionFilter:y.dimensionFilter,measureSortDescending:y.measureSortDescending,outParameter:y.outParameter,inParameters:y.inParameters,parentProperty:y.parentProperty};if(i==="Donut"){I.labelWidthPercent=w;}var A=this.oState.alr_visualFilterBar._createFilterItemOfType(i,I);A.data("idx",z);A.attachFilterChange(function(J){var z=J.getSource().data("idx");E._filterModified=true;E._updateFilterCount(z);E.oState.alr_visualFilterBar.fireFilterChange({filterList:J.getParameter('filterList'),property:J.getParameter('property'),filterRestriction:J.getParameter('filterRestriction')});E._applyFilterSelections();});A.attachTitleChange(function(J){var z=J.getSource().data("idx");if(I.isMandatory){E.filterCompList[z].toolbar.getItems()[0]._oLabel.addStyleClass("sapMLabelRequired");}E.filterCompList[z].toolbar.getItems()[0].setText(E._getChartTitle(E.filterCompList[z].obj,z));});return A;},_createMoreFiltersLink:function(y){var z=this;var A=0;var i;var E=new e();for(i=0;i<this.filterCompList.length;i++){if(this.filterCompList[i].searchVisible&&this.filterCompList[i].obj.group.name===y&&!this.filterCompList[i].obj.shownInFilterDialog){A++;}}if(A>0){E.setText(this.oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[A]));}else{E.setText(this.oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS"));}E.attachPress(function(I){z._createAddRemoveFiltersDialog(y,E);});return E;},_showChartMeasuresPopup:function(E){var i=this;var y=E.getSource().data("idx");var z=this.filterChartList[y].getProperty("entitySet");var A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(E.getSource().getModel('i18n'),"VISUAL_FILTER_MEASURES");var I=new f({mode:sap.m.ListMode.SingleSelectLeft});I.data("idx",y);A.addContent(I);var J=this.oState.alr_visualFilterBar._getMeasureMap()[z];I.addStyleClass("sapUiSizeCompact");if(J){for(var K in J){var M=new j({title:J[K].label}).data("measureName",J[K].name);I.addItem(M);if(this.filterChartList[y].getMeasureField()===J[K].name){I.setSelectedItem(M);}}}I.attachSelectionChange(function(E){var y=E.getSource().data("idx");i.filterChartList[y].setMeasureField(E.getSource().getSelectedItem().data("measureName"));i.filterCompList[y].toolbar.getItems()[0].setText(i._getChartTitle(i.filterCompList[y].obj,y));A.close();});A.attachAfterClose(function(){A.destroy();A=null;});A.openBy(E.getSource());},_showChartTypesPopup:function(E){var y=this;var z=E.getSource();var A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(E.getSource().getModel('i18n'),"VISUAL_FILTER_CHART_TYPES");var I=this.oState.alr_visualFilterBar._getSupportedFilterItemList();var J=[];for(var i=0;i<I.length;i++){var K=I[i];var M=new j({title:"{i18n>"+K.textKey+"}",icon:K.iconLink,selected:z.getIcon()===K.iconLink}).data("type",K.type);J.push(M);}var N=new f({mode:sap.m.ListMode.SingleSelectMaster,items:J});N.data("button",z);N.addStyleClass("sapUiSizeCompact");A.addContent(N);N.attachSelectionChange(function(E){var O=E.getSource().data("button").data("idx");var Q=E.getSource().getSelectedItem().data("type");var R=y.filterChartList[O].getP13NConfig();y.filterCompList[O].obj.component.type=Q;E.getSource().data("button").setIcon(y._getChartTypeIconLink(Q));y.filterChartList[O]=y._addChart(Q,R,O);y._applyFilterSelections();A.close();});A.attachBeforeClose(function(){y.oVerticalBox.removeAllItems();y._addFilterSwitch();y._addGroupsAndFilters();});A.attachAfterClose(function(){A.destroy();A=null;});A.openBy(E.getSource());},_showLineChartTimeAxisPopup:function(E){var i=E.getSource().data("idx");var y=E.getSource();var z=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(E.getSource().getModel('i18n'),"VISUAL_FILTER_LINE_CHART_TIME_LINE");var A=new f({mode:sap.m.ListMode.SingleSelectLeft,items:[new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_DAYS}"}).data("idx",i),new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_MONTH}"}).data("idx",i),new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_QUARTERS}"}).data("idx",i),new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_YEARS}"}).data("idx",i)]});A.data("button",y);A.addStyleClass("sapUiSizeCompact");z.addContent(A);A.attachSelectionChange(function(E){z.close();});z.attachAfterClose(function(){z.destroy();z=null;});z.openBy(E.getSource());},_showChartSortPopup:function(E){var i=this;var y=E.getSource().data("idx");var z=E.getSource();var A=E.getSource().getModel('i18n');var I=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(A,"VISUAL_FILTER_SORTING");var J=new f({mode:sap.m.ListMode.SingleSelectLeft,items:[new j({title:A.getResourceBundle().getText("VISUAL_FILTER_SORTING_ASCENDING")}).data("idx",y),new j({title:A.getResourceBundle().getText("VISUAL_FILTER_SORTING_DESCENDING")}).data("idx",y)]});J.data("button",z);J.addStyleClass("sapUiSizeCompact");if(this.filterChartList[y].getSortOrder()[0].Descending.Boolean){J.setSelectedItem(J.getItems()[1],true);}else{J.setSelectedItem(J.getItems()[0],true);}I.addContent(J);J.attachSelectionChange(function(E){var z=E.getSource().data("button");var y=z.data("idx");var K=jQuery.extend(true,[],i.filterChartList[y].getSortOrder());K[0].Descending.Boolean=E.getSource().getItems()[1].isSelected();i.filterChartList[y].setSortOrder(K);if(i.filterChartList[y].getSortOrder()[0].Descending.Boolean){z.setIcon("sap-icon://sort-descending");}else{z.setIcon("sap-icon://sort-ascending");}I.close();});I.attachAfterClose(function(){I.destroy();I=null;});I.openBy(E.getSource());},_createAddRemoveFiltersDialog:function(y,z){var i;var A=this;var E=new sap.m.Dialog();E.setTitle(this.oRb.getText("SELECT_FILTER_FIELDS"));E.addStyleClass("sapUiPopupWithPadding");E.addStyleClass("sapUiCompAddRemoveFilterDialog");E.addStyleClass("sapUiSizeCompact");E.setVerticalScrolling(true);var I=new b();var J=new S({placeholder:this.oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=J;J.attachLiveChange(function(M){A._onAddRemoveFiltersSearch(M);});I.addContentRight(J);E.setSubHeader(I);this.addRemoveList=new f({mode:sap.m.ListMode.MultiSelect});this.addRemoveList.setShowSeparators(k.None);E.addContent(this.addRemoveList);for(i=0;i<this.filterCompList.length;i++){if(this.filterCompList[i].obj.group.name===y&&this.filterCompList[i].searchVisible){var K=new j({title:this._getChartTitle(this.filterCompList[i].obj,i,true)}).data("idx",i);this.addRemoveList.addItem(K);if(this.filterCompList[i].obj.shownInFilterDialog){this.addRemoveList.setSelectedItem(K,true);}}}var O=new B({text:this.oRb.getText("FORM_PERS_DIALOG_OK")});O.attachPress(function(){var i;var M=A.addRemoveList.getItems();for(i=0;i<M.length;i++){var N=M[i].data("idx");A.filterCompList[N].obj.shownInFilterDialog=M[i].isSelected();}A.oVerticalBox.removeAllItems();A._addFilterSwitch();A._addGroupsAndFilters();E.close();});E.addAggregation("buttons",O);E.setInitialFocus(this._oSearchField);E.setContentHeight("23.25rem");var t=new B({text:this.oRb.getText("FORM_PERS_DIALOG_CANCEL"),press:function(){E.close();}});E.addAggregation("buttons",t);E.attachAfterClose(function(){E.destroy();E=null;});E.open();},_onAddRemoveFiltersSearch:function(E){var i;if(!E){return;}var y=E.getParameters();if(!y){return;}var z=(y.newValue?y.newValue:"").toLowerCase();var A=this.addRemoveList.getItems();for(i=0;i<A.length;i++){var I=(A[i].getTitle()).toLowerCase();A[i].setVisible(I.indexOf(z)>=0);}},_getChartTypeIconLink:function(i){var y=this.oState.alr_visualFilterBar._getSupportedFilterItemMap();var z=y[i];return!z?"":z.iconLink;},_getChartTitle:function(i,y,z){var A="";if(this.filterChartList[y]){if(z){i.component.properties=this.filterChartList[y].getP13NConfig();A=this.oState.alr_visualFilterBar.getTitleByFilterItemConfig(i);}else{A=this.filterChartList[y].getTitle();}}else{A=this.oState.alr_visualFilterBar.getTitleByFilterItemConfig(i);}return A;},_adjustToolbarIcons:function(i){if(this.filterCompList[i].obj.component.type==="Line"){this.filterCompList[i].toolbar.getItems()[1].getItems()[1].setVisible(true);this.filterCompList[i].toolbar.getItems()[1].getItems()[2].setVisible(false);}else{this.filterCompList[i].toolbar.getItems()[1].getItems()[1].setVisible(false);this.filterCompList[i].toolbar.getItems()[1].getItems()[2].setVisible(true);}},_applyFilterSelections:function(){this.oState.alr_visualFilterBar._updateFilterItemList(this.filterChartList);},_clearFilters:function(){for(var i=0;i<this.filterCompList.length;i++){this.filterChartList[i].setDimensionFilter([]);this.filterChartList[i].setDimensionFilterExternal([]);this._updateFilterCount(i);}this.oState.alr_visualFilterBar.fireFilterChange({filterItemList:this.filterChartList});this._applyFilterSelections();},_updateFilterCount:function(i){if(this.filterChartList[i].getDimensionFilter()&&this.filterChartList[i].getDimensionFilter().length>0){var y=this.oRb.getText("VALUEHELPDLG_SELECTEDITEMS_SHORT",[this.filterChartList[i].getDimensionFilter().length]);this.filterCompList[i].toolbar.getItems()[1].getItems()[0].setVisible(true);this.filterCompList[i].toolbar.getItems()[1].getItems()[0].setText(y);}else{this.filterCompList[i].toolbar.getItems()[1].getItems()[0].setVisible(false);}},_triggerSearchInFilterDialog:function(E){var i;if(!E){return;}var y=E.getParameters();if(!y){return;}var z=(y.newValue?y.newValue:"").toLowerCase();for(i=0;i<this.filterCompList.length;i++){var A=(this.filterCompList[i].toolbar.getItems()[0].getText()).toLowerCase();this.filterCompList[i].searchVisible=A.indexOf(z)>=0;}this.oVerticalBox.removeAllItems();this._addFilterSwitch();this._addGroupsAndFilters();}});sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog=function(i,y){var z=new sap.m.Popover();z.setTitle(i.getResourceBundle().getText(y));z.setPlacement(sap.m.PlacementType.PreferredBottomOrFlip);z.addStyleClass("sapUiPopupWithPadding");return z;};sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController.launchAllFiltersPopup=function(y,z,A){var i;var E=z.getDimensionFilter();var I=z.getFilterRestriction();var J=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(A,"VISUAL_FILTER_ALL_SELECTED_FILTERS");var K=new f({mode:sap.m.ListMode.Delete});K.data("chart",z);J.addContent(K);J.addStyleClass("sapUiSizeCompact");J.addStyleClass("alpSelectedLinkDialog");var M=new sap.m.Bar();var q=new B({text:A.getResourceBundle().getText("CLEAR_FILTERS_ALL"),press:function(O){var Q=K.data("chart");E.length=0;J.removeContent(K);Q.setDimensionFilter(E);Q.fireFilterChange({filterList:E,property:Q.getParentProperty(),filterRestriction:Q.getFilterRestriction()});J.close();}});M.addContentRight(q);J.setFooter(M);if(I!=="single"){for(i=0;i<E.length;i++){var N=new j({title:F.createTitle(E[i].dimValueDisplay,E[i].dimValue)});K.addItem(N);}}else{K.addItem(new j({title:E[0].dimValue}));}K.attachDelete(function(O){var Q=O.getParameter("listItem");var R=K.data("chart");var U=K.indexOfItem(Q);E.splice(U,1);K.removeItem(Q);R.setDimensionFilter(E);R.fireFilterChange({filterList:E,property:R.getParentProperty(),filterRestriction:R.getFilterRestriction()});J.focus();});J.attachAfterClose(function(){J.destroy();J=null;});J.openBy(y);};return x;});
