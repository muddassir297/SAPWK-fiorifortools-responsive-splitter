/*!
 * 
 * 		SAP UI development toolkit for HTML5 (SAPUI5)
 * 		(c) Copyright 2009-2015 SAP SE. All rights reserved
 * 	
 */
jQuery.sap.declare("sap.suite.ui.commons.TimelineItemRenderer");sap.ui.define("sap.suite.ui.commons.TimelineItemRenderer",["jquery.sap.global","sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/TimelineAlignment","sap/ui/core/format/DateFormat"],function(q,H,T,D){"use strict";var a={};var r=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");a.render=function(R,t){this._getTimelineItemElement(t).getRenderer().render(R);};a._getTimelineItemElement=function(t){if(t._orientation==="V"){return this._getVerticalTimelineItemElement(t);}else{return this._getHorizontalTimelineItemElement(t);}};a._getFormatedDateTime=function(t,A){A=A||{};var R=A.resBundle||r,d=A.dateFormat||D.getDateInstance({style:"short"}),o=A.timeFormat||D.getTimeInstance({style:"short"}),b=t.getDateTimeWithoutStringParse(),c,e,i,C;if(!(b instanceof Date)){return b;}c=new Date(b);c.setHours(0,0,0,0);e=new Date();e.setHours(0,0,0,0);i=Math.floor((e.valueOf()-c.valueOf())/(24*3600*1000));switch(i){case 0:C=R.getText("TIMELINE_TODAY");break;case 1:C=R.getText("TIMELINE_YESTERDAY");break;default:C=d.format(b);}return C+" "+R.getText("TIMELINE_AT")+" "+o.format(b);};a._getHorizontalTimelineItemElement=function(t){var i=(t._placementLine==="top"),s=i?"sapSuiteUiCommonsTimelineItemHTop":"sapSuiteUiCommonsTimelineItemHBottom",I=t.getText()==="GroupHeader",g=t._groupID,A,o;if(I){return this._getGroupHeaderElement(t);}var e=new H("li"),b=new H("div"),c=new H("div"),d=new H("div"),f=new H("div"),h=new H("div"),j=new H("div"),k=this._getTimelineItemSheell(t);if(g){e.setAttribute("groupid",t._groupID);}this._addAccessibilityTags(e,t);if(t._isFirstGroupEvenItem){e.setAttribute("firstgroupevenitem",t._isFirstGroupEvenItem);}e.addControlData(t);e.addClass("sapSuiteUiCommonsTimelineItemLiWrapperV");e.addClass(s);b.addClass("sapSuiteUiCommonsTimelineItemWrapperH sapSuiteUiCommonsTimelineItemBaseLength");e.addChild(b);c.addClass("sapSuiteUiCommonsTimelineItemBubbleSpacer");b.addChild(c);d.addClass("sapSuiteUiCommonsTimelineItemBubble");c.addChild(d);f.addClass("sapSuiteUiCommonsTimelineItemOutline");f.setId(t.getId()+"-outline");f.setAttribute("tabindex","-1");f.setAttribute("data-sap-ui-fastnavgroup",true);h.addClass("sapSuiteUiCommonsTimelineItemBox");f.addChild(h);j.addClass("sapSuiteUiCommonsTimelineItemArrow");if(i){d.addChild(f);d.addChild(j);}else{d.addChild(j);d.addChild(f);}if(!t._callParentFn("_isGrouped")&&t._callParentFn("getEnableDoubleSided")&&t._index===1){o=t.getParent();A="margin-left";if(o&&o._bRtlMode){A="margin-right";}e.addStyle(A,"100px");}h.addChild(k);if(t._isGroupCollapsed()){e.addStyle("display","none");}return e;};a._getGroupHeaderElement=function(t){var e=new H("li"),b=new H("div"),c=new H("div"),d=new H("div"),f=new H("div"),g=new H("div"),h=new H("span"),i=new H("div"),j=new H("div"),k=new H("div"),l=t._orientation==="V"?c:d,m=new H("div"),n=new H("div"),o=new H("div");var I=t._isGroupCollapsed(),s;if(t._groupID){e.setAttribute("groupid",t._groupID);}e.addControlData(t);e.addClass("sapSuiteUiCommonsTimelineGroupHeader");this._addAccessibilityTags(e,t,true);e.addChild(b);b.addChild(c);b.addClass("sapSuiteUiCommonsTimelineGroupHeaderDirectChild");c.addClass("sapSuiteUiCommonsTimelineGroupHeaderMainWrapper");c.setId(t.getId()+"-outline");c.setAttribute("tabindex","-1");c.setAttribute("data-sap-ui-fastnavgroup",true);c.addChild(d);e.addChild(k);e.setAttribute("nodeType","GroupHeader");f.addClass("sapSuiteUiCommonsTimelineGroupHeaderSpanWrapper");if(t._orientation==="V"){e.addClass(t._position===T.Left?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");}d.addClass("sapSuiteUiCommonsTimelineGroupHeaderWrapper");d.addClass("sapSuiteUiCommonsTimelineGroupHeaderPointer");d.setAttribute("title",t.getTitle(),true);l.addChild(g);d.addChild(j);d.addChild(f);e.addClass(I?"sapSuiteUiCommonsTimelineGroupCollapsed":"sapSuiteUiCommonsTimelineGroupExpanded");j.addClass("sapSuiteUiCommonsTimelineGroupHeaderIconWrapper");s=t._getCorrectGroupIcon();t._objects.register("groupCollapseIcon",function(){var p=new sap.ui.core.Icon(t.getId()+"-groupCollapseIcon",{src:s,decorative:true});p.addStyleClass("sapSuiteUiCommonsTimelineGroupHeaderPointer");p.setParent(t);return p;});j.addChild(t._objects.getGroupCollapseIcon());g.addClass("sapSuiteUiCommonsTimelineItemArrow");k.addClass("sapSuiteUiCommonsTimelineGroupHeaderLineWrapper");i.addClass("sapSuiteUiCommonsTimelineGroupHeaderLine");k.addChild(i);f.addChild(h);h.addClass("sapSuiteUiCommonsTimelineGroupHeaderSpan");h.addChildEscaped(" "+t.getTitle());if(t._orientation==="V"){e.addChild(m);n.addChild(t._getLineIcon());m.addChild(n);n.addClass("sapSuiteUiCommonsTimelineItemBarIconWrapperV");m.addClass("sapSuiteUiCommonsTimelineGroupHeaderBarWrapper");if(!t._isGroupCollapsed()){m.addStyle("display","none");}o.addClass("sapSuiteUiCommonsTimelineItemBarV");m.addChild(o);if(t._additionalBarClass){o.addClass(t._additionalBarClass);}}return e;};a._getVerticalTimelineItemElement=function(t){var e=new H("li"),b=new H("div"),c=new H("div"),d=new H("div"),f=new H("div"),g=new H("div"),h=new H("div"),i=new H("div"),j=new H("div"),k=new H("div"),l=new H("div"),m;var n=t._callParentFn("getShowIcons"),G=t._groupID,I=t.getText()==="GroupHeader",s=t._getStatusColorClass();if(I){return this._getGroupHeaderElement(t);}this._addAccessibilityTags(e,t);if(G){e.setAttribute("groupID",G);}e.addControlData(t);e.addClass("sapSuiteUiCommonsTimelineItem");e.setAttribute("nodeType","GroupItem");b.addClass(I?"sapSuiteUiCommonsTimelineItemWrapperGrp":"sapSuiteUiCommonsTimelineItemWrapperV");e.addChild(b);b.addClass(t._position===T.Left?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");b.addChild(f);b.addChild(c);c.addClass("sapSuiteUiCommonsTimelineItemBarWrapperV");d.addClass("sapSuiteUiCommonsTimelineItemBarIconWrapperV");if(s){d.addClass(s);}if(n){c.addChild(d);d.addChild(t._getLineIcon('',G));}else{l.addChild(k);l.addClass("sapSuiteUiCommonsTimelineItemNoIconWrapper");k.addClass("sapSuiteUiCommonsTimelineItemNoIcon");c.addChild(l);if(s){k.addClass(s);}}g.addClass("sapSuiteUiCommonsTimelineItemBarV");c.addChild(g);if(t._additionalBarClass){g.addClass(t._additionalBarClass);}f.addClass("sapSuiteUiCommonsTimelineItemBubble");j.addClass("sapSuiteUiCommonsTimelineItemArrow");f.addChild(j);f.addChild(i);i.addClass("sapSuiteUiCommonsTimelineItemOutline");i.setId(t.getId()+"-outline");i.setAttribute("tabindex","-1");i.setAttribute("data-sap-ui-fastnavgroup",true);h.addClass("sapSuiteUiCommonsTimelineItemBox");i.addChild(h);m=this._getTimelineItemSheell(t);h.addChild(m);if(t._isGroupCollapsed()){e.addStyle("display","none");}return e;};a._getTimelineItemSheell=function(t){var e=new H("div"),b=new H("div"),c=new H("div"),d=new H("span"),u,U,o,f=new H("span"),g=new H("div"),h=new H("div"),i=new H("div"),j=new H("span"),k=new H("div"),l=new H("span"),m=new H("div"),I;var E=t.getEmbeddedControl();e.setId(t.getId()+"-shell");e.addClass("sapSuiteUiCommonsTimelineItemShell");e.addChild(t._objects.getInfoBar());e.addChild(b);b.addClass("sapSuiteUiCommonsTimelineItemHeaderWrapper");u=t._getUserPictureControl();if(u){u.addStyleClass("sapSuiteUiCommonsTimelineItemUserPicture");b.addChild(u);}c.setAttribute("title",t.getUserName()+" "+t.getTitle(),true);c.setId(t.getId()+"-header");c.addClass("sapSuiteUiCommonsTimelineItemHeader");c.addClass("sapSuiteUiCommonsTimelineItemTextLineClamp");d.setId(t.getId()+"-username");d.addClass("sapSuiteUiCommonsTimelineItemShellUser");c.addChild(d);o=t._getUserNameLinkControl();if(o){d.addChild(o);}else{d.addChildEscaped(t.getUserName());d.addClass("sapUiSelectable");}b.addChild(c);f.addClass("sapSuiteUiCommonsTimelineItemShellHdr");f.addClass("sapUiSelectable");f.addChildEscaped(" "+t.getTitle());c.addChild(f);g.addClass("sapSuiteUiCommonsTimelineItemShellDateTime");g.addClass("sapUiSelectable");g.addChildEscaped(this._getFormatedDateTime(t));c.addChild(g);h.addClass("sapSuiteUiCommonsTimelineItemShellBody");e.addChild(h);if(E!==null){h.addChild(E);}else{if(t.getText()){i.addChild(j);i.addClass("sapSuiteUiCommonsTimelineItemTextWrapper");j.setId(t.getId()+"-realtext");j.addClass("sapUiSelectable");h.addChild(i);I=t._checkTextIsExpandable();if(I){l.setId(t.getId()+"-threeDots");l.addClass("sapMFeedListItemTextString");l.addChildEscaped(" ");i.addChild(l);j.addChildEscaped(t._getCollapsedText(),true);l.addChildEscaped("... ");i.setAttribute("expandable",true);}else{j.addChildEscaped(t.getText(),true);k.addStyle("display","none");}h.addChild(k);k.addClass("sapSuiteUiCommonsTimelineItemShowMore");k.addChild(t._getButtonExpandCollapse());}}if(t.getParent()&&t.getParent()._aFilterList&&(t._callParentFn("getEnableSocial")||t.getCustomAction().length>0)){m.addClass("sapSuiteUiCommonsTimelineItemShellBottom");m.addChild(t._objects.getSocialBar());e.addChild(m);}return e;};a._addAccessibilityTags=function(e,t,i){var g;e.setAttribute("role","listitem");if(typeof t._index==="number"){e.setAttribute("aria-posinset",t._index);e.setAttribute("aria-setsize",t._callParentFn("_getItemsCount"));}e.setAttribute("aria-live","polite");if(i){e.setAttribute("aria-expanded",t._isGroupCollapsed()||"");g=r.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+t.getTitle();e.setAttribute("aria-label",g);}};return a;},true);
