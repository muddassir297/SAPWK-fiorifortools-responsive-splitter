(function(){"use strict";sap.ui.controller("sap.ovp.cards.list.List",{counter:0,arrayLength:0,minMaxModel:{},onInit:function(){this.counter=0;this.minMaxModel=new sap.ui.model.json.JSONModel();this.minMaxModel.setData({minValue:1,maxValue:-1});this.getView().setModel(this.minMaxModel,"minMaxModel");},onAfterRendering:function(){var i=this.getCardPropertiesModel().oData.imageSupported;var d=this.getCardPropertiesModel().oData.densityStyle;if(i&&i==="true"){var a=this.byId('ovpList');a.attachUpdateFinished(function(){var l=this.byId('ovpList');var b=l.getItems();var c=false;var e=l.getDomRef().getAttribute("class");if(d==="cozy"){e=e+" sapOvpListImageCozy";}else{e=e+" sapOvpListImageCompact";}l.getDomRef().setAttribute("class",e);b.forEach(function(f){if(f.getIcon().indexOf("icon")!=-1){c=true;}});b.forEach(function(f){var g=f.getDomRef();var h;if(g&&g.children[0]&&g.children[0].children[0]){h=g.children[0].children[0];}var j=f.getDescription();var k=f.getIcon();var t=c;var m=f.getTitle();var n=m.split(' ').map(function(s){return s?s[0].toUpperCase():"";}).join('').substring(0,2);if(k!=""&&k.indexOf("icon")==-1){c=false;}if(h&&d==="cozy"&&c===false){if(h){var e=h.getAttribute("class");e=e+" sapOvpImageCozy";h.setAttribute("class",e);}}var o="";if(c===true&&j===""){o=d==="compact"?"sapOvpListWithIconNoDescCompact":"sapOvpListWithIconNoDescCozy";}else if(c===false&&j===""){o=d==="compact"?"sapOvpListWithImageNoDescCompact":"sapOvpListWithImageNoDescCozy";}else{o=d==="compact"?"sapOvpListWithImageIconCompact":"sapOvpListWithImageIconCozy";}f.addStyleClass(o);if(g&&g.children[0]&&k===""&&g.children[0].id!=="ovpIconImagePlaceHolder"){var p=document.createElement('div');p.innerHTML=n;p.setAttribute("id","ovpIconImagePlaceHolder");p.className=c===true?"sapOvpIconPlaceHolder":"sapOvpImagePlaceHolder";if(c===false&&d==="cozy"){p.className=p.className+" sapOvpImageCozy";}g.insertBefore(p,g.children[0]);}c=t;});}.bind(this));}},onListItemPress:function(e){var n=this.getEntityNavigationEntries(e.getSource().getBindingContext(),this.getCardPropertiesModel().getProperty("/annotationPath"));this.doNavigation(e.getSource().getBindingContext(),n[0]);},_getMinMaxObjectFromContext:function(){this.counter++;var e=this.getEntityType(),a=this.getCardPropertiesModel().getProperty("/annotationPath"),r=e[a],c=this.getMetaModel().createBindingContext(e.$path+"/"+a),m={minValue:1,maxValue:-1};if(sap.ovp.cards.AnnotationHelper.isFirstDataPointPercentageUnit(c,r)){m.minValue=0;m.maxValue=100;return m;}var d=sap.ovp.cards.AnnotationHelper.getFirstDataPointValue(c,r),b=this.getView().byId("ovpList"),l=b.getBinding("items"),f=l.getCurrentContexts();for(var i=0;i<f.length;i++){var g=parseInt(f[i].getObject()[d],10);if(g<m.minValue){m.minValue=g;}else if(g>m.maxValue){m.maxValue=g;}}return m;},_updateMinMaxModel:function(){var m=this._getMinMaxObjectFromContext();this.minMaxModel.setData({minValue:m.minValue,maxValue:m.maxValue});this.minMaxModel.refresh();return m;},returnBarChartValue:function(v){var m=this._updateMinMaxModel();var V=parseInt(v,10);if(V!==0){return V;}else if(m.maxValue<=0){return-0.5;}else if(m.minValue>=0){return 0.5;}return V;},getCardItemsBinding:function(){var l=this.getView().byId("ovpList");return l.getBinding("items");},getCardItemBindingInfo:function(){var l=this.getView().byId("ovpList");return l.getBindingInfo("items");},resizeCard:function(n){var N,a;try{var c=this.getCardPropertiesModel(),b=this.getCardItemBindingInfo(),d=this.oDashboardLayoutUtil.calculateCardProperties(this.cardId),$=jQuery('#'+this.oDashboardLayoutUtil.getCardDomId(this.cardId));a=n.rowSpan*n.iRowHeightPx-(d.headerHeight+d.dropDownHeight+2*n.iCardBorderPx);if(d.itemHeight){N=Math.floor(a/d.itemHeight);}jQuery($).find(".sapOvpWrapper").css({height:((n.rowSpan*n.iRowHeightPx)-(d.headerHeight+2*n.iCardBorderPx))+"px"});c.setProperty("/cardLayout/rowSpan",n.rowSpan);c.setProperty("/cardLayout/colSpan",n.colSpan);c.setProperty("/cardLayout/noOfItems",N);b.length=N<1?1:N;this.getCardItemsBinding().refresh();}catch(e){jQuery.sap.log.warning("OVP resize: "+this.cardId+" catch "+e.toString());}}});})();
