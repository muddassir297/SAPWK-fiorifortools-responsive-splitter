(function(){"use strict";sap.ui.controller("sap.ovp.cards.map.GeographicalMap",{onInit:function(e){var s=this.getView().mPreprocessors.xml[0].ovpCardProperties.oData.state;if(s!=="Loading"&&s!=="Error"){var h=this.getView().byId("popoverHeader");h.attachBrowserEvent("click",this.onPopoverHeaderPress.bind(this,h));h.addEventDelegate({onkeydown:function(E){if(!E.shiftKey&&(E.keyCode==13||E.keyCode==32)){E.preventDefault();this.onPopoverHeaderPress(h);}}.bind(this)});}},resizeCard:function(n){},onPopoverHeaderPress:function(h){var n=this.getEntityNavigationEntries(h.getBindingContext(),this.getCardPropertiesModel().getProperty("/annotationPath"));this.doNavigation(h.getBindingContext(),n[0]);},onClickSpot:function(e){var s=e.getSource();var c={};c[e.getParameter("data").Action.Params.Param[0].name]=e.getParameter("data").Action.Params.Param[0]["#"];c[e.getParameter("data").Action.Params.Param[1].name]=e.getParameter("data").Action.Params.Param[1]["#"];var v=this.getView().byId("oVBI");var b=v.getDomRef().getBoundingClientRect();if(!this.oQuickViewPopover){this.oQuickViewPopover=this.getView().byId("quickViewPopover");}else{this.oQuickViewPopover.close();}this.oPopoverModel=new sap.ui.model.json.JSONModel({objectAttribute1:s.mClickGeoPos,objectAttribute2:s.getId(),offsetX:Math.floor(parseFloat(c.x)-b.width)+10,offsetY:Math.floor(parseFloat(c.y)-b.height/2)-5,test:"987"});this.oQuickViewPopover.setModel(this.oPopoverModel,"popover");this.oQuickViewPopover.openBy(v);this.oQuickViewPopover.setBindingContext(s.getBindingContext());},onBeforeRendering:function(){var v=this.getView().byId("oVBI");v.getAggregation("vos")[0].getBinding("items").attachChange(function(i){var z=[],a=[];this.getAggregation("vos")[0].getItems().forEach(function(i){var p=i.getPosition();if(p!='0;0;0'){var L=i.getPosition().split(";")[0];var b=i.getPosition().split(";")[1];z.push(Number(L));a.push(Number(b));}});if(z.length>1){this.zoomToGeoPosition(z,a);}if(z.length<=1){this.zoomToGeoPosition(z,a,5);}}.bind(v));var m=this.getOwnerComponent().getComponentData().settings.oMapConfig;v.setMapConfiguration(m);}});})();
