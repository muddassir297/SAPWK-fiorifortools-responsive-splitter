/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/misc/Format"],function(F){"use strict";var U={};U.assign=function(i,d){if(typeof(i)!==typeof(d)){return d;}else if((typeof i==="undefined")||i===null){return d;}else{return i;}};U.assignDeep=function(i,d){if(!i&&!d){return null;}else if(i&&!d){return i;}else if(!i&&d){return d;}else if(typeof(i)==="object"&&typeof(d)==="object"){var r=i;for(var a in d){if(typeof(r[a])!=="boolean"&&!r[a]){r[a]=d[a];}else if(typeof(d[a])==="object"&&typeof(r[a])==="object"){r[a]=this.assignDeep(r[a],d[a]);}}return r;}else{return i;}};U.generateRowUid=function(d,o,s,p){jQuery.each(d,function(k,v){v.uid=v.id;if(p){v.uid=p+"|"+v.uid;}else if(v.bindingObj&&v.bindingObj.findNode){var n=v.bindingObj.findNode(v.rowIndex);while(n.parent&&n.level>0){n=n.parent;v.uid=n.context.getObject().id+"|"+v.uid;}}var a=(v.index===undefined)?-1:v.index;var c=(v.chartScheme===undefined)?"":v.chartScheme;v.uid="PATH:"+v.uid+"|SCHEME:"+c+"["+a+"]";v.data.uid=v.uid;for(var i=0;i<s.length;i++){var D=s[i];if(D in v.data){for(var j=0;j<v.data[D].length;j++){var b=v.data[D][j];if(b.id===undefined){b.id=jQuery.sap.uid();}b.uid=v.uid+"|DATA:"+D+"["+b.id+"]";}}}});};U.getChartSchemeByShapeUid=function(s){return U.parseUid(s).chartScheme||"";};U.generateUidForRelationship=function(d){var s="relationship";var D="PATH:DUMMY|SCHEME:DUMMY[0]";for(var i=0;i<d.length;i++){if(d[i].id===undefined){d[i].id=jQuery.sap.uid();}d[i].uid=D+"|DATA:"+s+"["+d[i].id+"]";}};U.generateObjectPathToObjectMap=function(d,m,p){var r;for(var i in d){var o=d[i],a;if(o.objectInfoRef){a=o.objectInfoRef.data.id;o=o.objectInfoRef;}else{a=o.data.id;}if(p&&p!=""){a=p.concat(".").concat(a);}m[a]=o;if(o.children&&o.children.length>0){r=this.generateObjectPathToObjectMap(o.children,m,a);}}return r;};U.getShapeDataNameByUid=function(s){return U.parseUid(s).shapeDataName;};U.getIdByUid=function(u,r){return r?U.parseUid(u).rowId:U.parseUid(u).shapeId;};U.parseUid=function(u){var r=/(PATH:(.+)\|SCHEME:(.*?\[-?\d+\]))(?:\|DATA:(.+)\[(.*)\])?$/g;var m=r.exec(u);var a={};if(m){var c=m[3];if(c){c=c.replace(/\[-?\d+\]/,"");}var R=m[1],s=m[2],b=s.split("|"),d=b[b.length-1];a={rowId:d,rowPath:s,rowUid:R,chartScheme:c,shapeDataName:m[4],shapeId:m[5]};}return a;};U.scaleBySapUiSize=function(m,n){switch(m){case"sapUiSizeCozy":return n*1.5;case"sapUiSizeCondensed":return n*0.78;default:return n;}};U.findSapUiSizeClass=function(c){var a,b;if(c){a=c.$();}else{a=jQuery("body");}if(a){b=a.closest(".sapUiSizeCompact,.sapUiSizeCondensed,.sapUiSizeCozy");if(b.hasClass("sapUiSizeCondensed")){return"sapUiSizeCondensed";}else if(b.hasClass("sapUiSizeCompact")){return"sapUiSizeCompact";}else if(b.hasClass("sapUiSizeCozy")){return"sapUiSizeCozy";}}};U.floatEqual=function(v,V){return Math.abs(v-V)<0.0001;};U.calculateStringLength=function(s){var l=0;if(s.match("[\u4E00-\u9FFF]")===null){l=s.length;}else{l=s.length+s.match(/[\u4E00-\u9FFF]/g).length;}return l;};U.judgeTimeHorizonValidity=function(v,t){var V=F.abapTimestampToDate(v.getStartTime()).getTime(),o=F.abapTimestampToDate(v.getEndTime()).getTime(),T=F.abapTimestampToDate(t.getStartTime()).getTime(),a=F.abapTimestampToDate(t.getEndTime()).getTime();return(V-T>=0)&&(a-o>=0);};U.getShapeDatumById=function(i,c){return U.getDatumById(i,"sap-gantt-shape-id",c);};U.getRowDatumById=function(i,c){return U.getDatumById(i,"sap-gantt-row-id",c)||[];};U.getRowDatumRefById=function(i,c){return U.getRowDatumById(i,c).map(function(I){return I.objectInfoRef;});};U.getRowDatumByShapeUid=function(s,c){var p=this.parseUid(s),r=p.rowUid,R=p.rowId;var d=null;var a=this.getRowDatumById(R,c);var f=a.filter(function(d){return d.objectInfoRef.uid.indexOf(r)>=0;});if(f.length>0){d=f[0].objectInfoRef;}return d;};U.getRowDatumByEventTarget=function(t){var d=null;var a=jQuery(t).closest("g[data-sap-gantt-row-id]");if(a.length){d=d3.select(a.get(0)).datum();}return d;};U.getDatumById=function(i,a,c){var p=i?i:"";var I=p;if(typeof p==="string"){I=[p];}var d=[];I.forEach(function(b){var s=["#",c," [data-",a,"='",b,"']"].join("");$(s).each(function(_,e){d.push(d3.select(e).datum());});});return jQuery.sap.unique(d);};return U;},true);
